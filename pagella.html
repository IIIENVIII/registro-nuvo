<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pagella</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f4f4f4;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #007bff;
            color: white;
        }
        tr:hover {
            background-color: #f1f1f1;
        }
        .vote-input {
            width: 50px;
            text-align: center;
        }
        .vote-red {
            color: red;
        }
        .vote-black {
            color: black;
        }
        select, button {
            margin-top: 10px;
            padding: 10px;
        }
    </style>
</head>
<body>

<h2>Seleziona i dettagli della pagella</h2>

<!-- Selezione tra 1° e 2° quadrimestre -->
<label for="quadrimestre">Scegli il quadrimestre:</label>
<select id="quadrimestre">
    <option value="">-- Seleziona --</option>
    <option value="1-quadrimestre">1° Quadrimestre</option>
    <option value="2-quadrimestre">2° Quadrimestre</option>
</select>

<!-- Selezione della classe -->
<label for="classe">Scegli la classe:</label>
<select id="classe">
    <option value="">-- Seleziona --</option>
    <option value="3-media">3 Media</option>
    <option value="1-superiore">1 Superiore</option>
</select>

<!-- Bottone per visualizzare la tabella -->
<button onclick="generateTable()">Visualizza Tabella</button>

<!-- Tabella dinamica -->
<table id="student-table" style="display:none;">
    <thead>
        <tr>
            <th>Nome</th>
            <th>Italiano</th>
            <th>Matematica</th>
            <th>Scienze</th>
            <th>Geografia</th>
            <th>Storia</th>
            <th>Ginnastica</th>
            <th>Arte</th>
            <th>Disegno</th>
            <th>Informatica</th>
            <th>Musica</th>
            <th>Promosso/Bocciato</th> <!-- Colonna Promosso/Bocciato -->
        </tr>
    </thead>
    <tbody id="table-body">
        <!-- Contenuto dinamico -->
    </tbody>
</table>

<script>
    // Nomi per 3 Media per 1° e 2° quadrimestre
    const studenti3Media = {
        "1-quadrimestre": [
            "Stellina Dematteis", "Tartaruga Dematteis", "Yucky Benua", "Lollo Benua", 
            "Leonard Benua", "Sparcky Benua", "Flaffy Dematteis", "Tina Dematteis", 
            "Grigetta Benua", "Luna Dematteis", "Luna Benua", "Kendy Dematteis", 
            "Papero Benua", "Curt Dematteis", "Briciola Dematteis", "Lampo Benua", 
            "Sunny Benua", "Attiglio Dematteis"
        ],
        "2-quadrimestre": [
            "Stellina Dematteis", "Tartaruga Dematteis", "Yucky Benua", "Lollo Benua", 
            "Leonard Benua", "Sparcky Benua", "Flaffy Dematteis", "Tina Dematteis", 
            "Grigetta Benua", "Luna Dematteis", "Luna Benua", "Kendy Dematteis", 
            "Papero Benua", "Curt Dematteis", "Briciola Dematteis", "Lampo Benua", 
            "Sunny Benua", "Attiglio Dematteis"
        ]
    };

    // Nomi per 1 Superiore per 1° e 2° quadrimestre
    const studenti1Superiore = {
        "1-quadrimestre": [
            "Cane Dematteis", "Cane Benua", "Mician Dematteis", "Cicciobello Allabue", 
            "Micheal Temperini", "Cattivo Temperini", "Bambola Rossetti", 
            "Teschio Carottini", "Robottina Carottini"
        ],
        "2-quadrimestre": [
            "Cane Dematteis", "Cane Benua", "Mician Dematteis", "Cicciobello Allabue", 
            "Micheal Temperini", "Cattivo Temperini", "Bambola Rossetti", 
            "Teschio Carottini", "Robottina Carottini"
        ]
    };

    // Materie
    const materie = [
        "Italiano", "Matematica", "Scienze", "Geografia", "Storia", 
        "Ginnastica", "Arte", "Disegno", "Informatica", "Musica"
    ];

    // Carica le selezioni e i voti dal localStorage al caricamento della pagina
    window.onload = function() {
        const quadrimestre = localStorage.getItem('quadrimestre');
        const classe = localStorage.getItem('classe');

        if (quadrimestre) {
            document.getElementById('quadrimestre').value = quadrimestre;
        }
        if (classe) {
            document.getElementById('classe').value = classe;
        }
        generateTable(true); // Ricarica la tabella se ci sono dati salvati
    };

    // Seleziona la classe e il quadrimestre e salva nel localStorage
    document.getElementById('quadrimestre').addEventListener('change', function() {
        localStorage.setItem('quadrimestre', this.value); // Salva nel localStorage
    });

    document.getElementById('classe').addEventListener('change', function() {
        localStorage.setItem('classe', this.value); // Salva nel localStorage
    });

    // Genera la tabella degli studenti e dei voti
    function generateTable() {
        const quadrimestre = document.getElementById('quadrimestre').value;
        const classe = document.getElementById('classe').value;

        if (!quadrimestre || !classe) {
            alert("Seleziona il quadrimestre e la classe.");
            return;
        }

        const tableBody = document.getElementById('table-body');
        tableBody.innerHTML = ''; // Pulisce il corpo della tabella

        // Scegli gli studenti in base alla classe e al quadrimestre
        let studenti;
        if (classe === '3-media') {
            studenti = studenti3Media[quadrimestre];
        } else if (classe === '1-superiore') {
            studenti = studenti1Superiore[quadrimestre];
        }

        studenti.forEach(nome => {
            const row = document.createElement('tr');
            row.innerHTML = `<td>${nome}</td>`;

            materie.forEach(materia => {
                const input = document.createElement('input');
                input.type = 'number';
                input.min = '10';
                input.max = '100';
                input.className = 'vote-input';
                input.value = localStorage.getItem(`${nome}-${materia}-${quadrimestre}`) || ''; // Carica il voto se esiste
                input.addEventListener('input', function() {
                    this.className = (this.value < 60) ? 'vote-input vote-red' : 'vote-input vote-black';
                    localStorage.setItem(`${nome}-${materia}-${quadrimestre}`, this.value); // Salva il voto nel localStorage
                });

                // Imposta il colore in base al voto esistente
                if (input.value < 60 && input.value !== '') {
                    input.className = 'vote-input vote-red';
                } else if (input.value !== '') {
                    input.className = 'vote-input vote-black';
                }

                const cell = document.createElement('td');
                cell.appendChild(input);
                row.appendChild(cell);
            });

            // Colonna "Promosso/Bocciato" solo per il 2° quadrimestre
            if (quadrimestre === "2-quadrimestre") {
                const select = document.createElement('select');
                select.innerHTML = `
                    <option value="Promosso" ${localStorage.getItem(`${nome}-promosso-${quadrimestre}`) === 'Promosso' ? 'selected' : ''}>Promosso</option>
                    <option value="Bocciato" ${localStorage.getItem(`${nome}-promosso-${quadrimestre}`) === 'Bocciato' ? 'selected' : ''}>Bocciato</option>
                `;
                select.addEventListener('change', function() {
                    localStorage.setItem(`${nome}-promosso-${quadrimestre}`, this.value); // Salva il risultato nel localStorage
                });

                const cell = document.createElement('td');
                cell.appendChild(select);
                row.appendChild(cell);
            } else {
                // Se non è il 2° quadrimestre, aggiungi una cella vuota
                const cell = document.createElement('td');
                row.appendChild(cell);
            }

            tableBody.appendChild(row);
        });

        document.getElementById('student-table').style.display = 'table'; // Mostra la tabella
    }
</script>

</body>
</html>
